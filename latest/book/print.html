<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title></title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="{% block description %}{% endblock %}">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <base href="">

        <link rel="stylesheet" href="book.css">
        <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

        <!-- Font Awesome -->
        <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="highlight.css">

        <link rel="stylesheet" href="static/css/cymbalum.css">

        <!-- MathJax -->
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });</script>
        <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Fetch JQuery from CDN but have a local fallback -->
        <script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script>
            if (typeof jQuery == 'undefined') {
                document.write(unescape("%3Cscript src='jquery.js'%3E%3C/script%3E"));
            }
        </script>
    </head>
    <body class="light">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var sidebar = localStorage.getItem('sidebar');
            if (sidebar === "hidden") { $("html").addClass("sidebar-hidden") }
            else if (sidebar === "visible") { $("html").addClass("sidebar-visible") }
        </script>

        <div id="sidebar" class="sidebar">
            <ul class="chapter"><li><a href="engine/intro.html"><strong>1.</strong> Introduction</a></li><li><ul class="section"><li><a href="engine/system.html"><strong>1.1.</strong> System</a></li><li><a href="engine/simulation.html"><strong>1.2.</strong> Simulation</a></li></ul></li><li><a href="input/intro.html"><strong>2.</strong> Input files</a></li><li><ul class="section"><li><a href="input/interactions.html"><strong>2.1.</strong> Interactions</a></li><li><a href="input/potentials.html"><strong>2.2.</strong> Potentials</a></li><li><strong>2.3.</strong> Initial configuration</li><li><a href="input/units.html"><strong>2.4.</strong> Units</a></li></ul></li><li><strong>3.</strong> Extending Cymbalum</li><li><ul class="section"><li><strong>3.1.</strong> Adding new potentials</li><li><strong>3.2.</strong> Adding a new output</li><li><strong>3.3.</strong> Extending Molecular dynamics</li><li><strong>3.4.</strong> Extending Monte-Carlo</li><li><strong>3.5.</strong> Adding a new propagator</li></ul>
        </div>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar" class="menu-bar">
                    <div class="left-buttons">
                        <i id="sidebar-toggle" class="fa fa-bars"></i>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <i id="print-button" class="fa fa-print" title="Print this book"></i>
                    </div>
                </div>

                <div id="content" class="content">
                    <h1>Welcome to Cymbalum user manual!</h1>
<p>Cymbalum is a flexible and extensible molecular simulation engine. That means:</p>
<ul>
<li>You can use it to drive classical molecular simulations; from Monte-Carlo to
molecular dynamics and energy minimization;</li>
<li>You have full control over the simulation steps, and the simulated system;</li>
<li>You can <em>easily</em> extend the engine with new algorithms, and hook into its
internals.</li>
</ul>
<p>This user manual describes how to use Cymbalum either as a command line tool or
a library.</p>
<h2>Systems and Simulations</h2>
<p>The two main concepts in Cymbalum are a <code>System</code> and a <code>Simulation</code>. A <code>System</code>
contains all the simulated system data: atomic names, positions and velocities,
force-field, simulation box. On the other hand, a <code>Simulation</code> contains
everything needed to run a simulation with a system, <em>i.e.</em> algorithms and
associated data.</p>
<p>A <code>System</code> is usually used in combination with one <code>Simulation</code> to explore the
properties of the system. Sometimes multiple systems can be associated with the
same simulation (in Gibbs ensemble Monte-Carlo or in parallel tempering); and
sometimes multiple simulations can be associated with the same system, when
running an energy minimization before a molecular dynamics run.</p>
<h1>System</h1>
<p>A <code>System</code> contains all the data about the physical system we are simulating.
It contains four types of data:</p>
<ul>
<li>A list of <strong>Particles</strong>, which are physical objects, with a position, a
velocity, a mass and a name;</li>
<li>A list of <strong>Molecules</strong> containing information about how the particles are
bounded together;</li>
<li>An <strong>UnitCell</strong>, <em>i.e.</em> the bounding box of the simulation.</li>
<li><strong>Interactions</strong>, sometimes called a force-field.</li>
</ul>
<p><img src="static/img/system.svg#center" alt="System components" /></p>
<h2>Unit cells</h2>
<p>Cymbalum knows about three types of unit cells:</p>
<ul>
<li>Infinite cells do not have any boundaries, and can be used to simulate
systems in vacuum;</li>
<li>Orthorhombic cells have up to three independent lengths, and all the angles
of the cell are set to 90°;</li>
<li>Triclinic cells have 6 independent parameters: 3 lengths and 3 angles.</li>
</ul>
<p>Orthorhombic and Triclinic cells are used in combination with <a href="https://en.wikipedia.org/wiki/Periodic_boundary_conditions">periodic boundary
conditions</a> to
simulate infinite systems.</p>
<h2>Interactions</h2>
<p>Interactions associate a potential and some particles kind. Cymbalum provides
code for various potentials types:</p>
<ul>
<li>Non-bonding pair potentials;</li>
<li>Bonds potentials in molecules;</li>
<li>Angles potentials in molecules;</li>
<li>Dihedral angles potentials in molecules;</li>
<li>Long-ranges coulombic potentials (Ewald and Wolf methods);</li>
<li>Arbitrary external potential applying on the whole system at once.</li>
</ul>
<h1>Simulation</h1>
<p>The flow of a simulation in Cymbalum is represented below.</p>
<p><img src="static/img/simulation.svg#center" alt="Simulation flow graph" /></p>
<p>First, it uses a system to setup any algorithms which uses system specific
informations.</p>
<p>Then it propagate the system for one step, compute the physical properties as
needed, and output these properties to the hard drive.</p>
<p>If the simulation is finished (either the required number of steps has been
done, or come convergence criterion is reached) it returns the updated system.
If the simulation is not finished, the system is propagated for one more step.</p>
<h2>Propagators</h2>
<p>Propagators are at the heart of a Simulation. They have the responsibility to
update the system at each simulation step. Currently, three propagators exists:
a molecular dynamics one, a Monte-Carlo one and a minimizer, for energy
minimization.</p>
<h1>Input files</h1>
<p>The input files in Cymbalum can be classified in three types:</p>
<ul>
<li>Initial configuration of the system;</li>
<li>Interactions and force field description;</li>
<li>Simulation setup and configuration.</li>
</ul>
<p>Currently, only the initial configuration of the system and the force field
input files are implemented. The initial configuration can be provided in
various formats. Check the <a href="input/initial.html">relevant documentation</a> for a
list and description of the formats.</p>
<p>The force field input file uses the <a href="https://github.com/toml-lang/toml">TOML</a>
format, a simple and minimalist configuration format based on <code>key = value</code>
pairs. If you do not know the syntax, <a href="https://github.com/toml-lang/toml">this
page</a> has a good introduction. The different
sections in the input file are described in the <a href="input/interactions.html">next
page</a>.</p>
<h2>Units in input</h2>
<p>The unit of a value can be defined by a specific string, which will be parsed
and converted to the <a href="input/units.html">internal unit system</a>.
If there is no unit in the string, the internal unit for this type is used.
No consistency check is performed, and it is up to the code users to check the
given units.</p>
<pre><code class="language-toml"># Here, 'cutoff' is a distance

# OK
cutoff = &quot;8 A&quot;
# OK, will use the internal unit of distance.
# This is not recommended. The internal unit may change, and the input convey less information
cutoff = &quot;8&quot;    
# OK, but big !
cutoff = &quot;8 km&quot;  

# OK, but probably not what you want. Will be interpreted as 8000 A
cutoff = &quot;8 ps&quot;
# invalid, 'cutoff' must be a string
cutoff = 8.0   
</code></pre>
<h1>Interactions</h1>
<p>The interactions in a system can be specified using <a href="https://github.com/toml-lang/toml">TOML</a> syntax. An
interaction is the association of atomic types, a potential function and
optionally restrictions and mode of computation.</p>
<p>The <code>pairs</code>, <code>bonds</code>, <code>angles</code> and <code>dihedrals</code> sections are arrays of
interactions, listing possible atomic combinations and associated potentials.
The <code>coulomb</code> section contains information about the treatment of long-range
electrostatic interactions, and charges section defines the partial charges of
the atoms.</p>
<p>All the potentials input file must have the <code>input.potentials.version</code> key
defined to the value 1. This value will change if the input files formating
changes.</p>
<p>An example of an input file for the f-SPC model of water is given bellow:</p>
<pre><code class="language-toml">[input.potentials]
version = 1

[[pairs]]
atoms = [&quot;O&quot;, &quot;O&quot;]
lj = {sigma = &quot;3.16 A&quot;, epsilon = &quot;0.155 kcal/mol&quot;}

[[pairs]]
atoms = [&quot;O&quot;, &quot;H&quot;]
null = {}

[[pairs]]
atoms = [&quot;H&quot;, &quot;H&quot;]
harmonic = {k = &quot;79.8 kcal/mol/A^2&quot;, x0 = &quot;1.633 A&quot;}
restriction = &quot;intra-molecular&quot;

[[bonds]]
atoms = [&quot;O&quot;, &quot;H&quot;]
harmonic = {k = &quot;1054.2 kcal/mol/A^2&quot;, x0 = &quot;1.0 A&quot;}

[[angles]]
atoms = [&quot;H&quot;, &quot;O&quot;, &quot;H&quot;]
harmonic = {k = &quot;75.9 kcal/mol/rad^2&quot;, x0 = &quot;109.5 deg&quot;}

[coulomb]
ewald = {cutoff = &quot;10 A&quot;, kmax = 7}

[charges]
O = -0.82
H = 0.41
</code></pre>
<h2>Pairs and molecular interactions</h2>
<p>The <code>pairs</code>, <code>bonds</code>, <code>angles</code> and <code>dihedrals</code> sections are arrays, in which
every entry must contain at least two keys: the <code>atoms</code> key, and a
<a href="input/potentials.html#Available%20potentials">potential</a> key. The <code>atoms</code> key
specifies the atom types to which the interaction should be applied and should
contain two atoms for <code>pairs</code> and <code>bonds</code>, three atoms for <code>angles</code> and four
atoms for <code>dihedrals</code>.</p>
<p>For example, to use a harmonic bond potential for all <code>C-H</code> bonds:</p>
<pre><code class="language-toml">[[bonds]]
atoms = [&quot;C&quot;, &quot;H&quot;]
harmonic = {x0 = &quot;3.405 A&quot;, k = &quot;2385 kcal/mol/A^2&quot;}
</code></pre>
<p>It is also possible in the <code>pairs</code> section to specify an additional
<a href="input/potentials.html#Restrictions">restriction</a> using the <code>restriction</code> key;
or a <a href="input/potentials.html#Potential%20computations">computation method</a> using
the <code>computation</code> key.</p>
<pre><code class="language-toml">[[pairs]]
atoms = [&quot;Ar&quot;, &quot;Ar&quot;]
lj = {sigma = &quot;3.405 A&quot;, epsilon = &quot;0.2385 kcal/mol&quot;}
computation = {table = {n = 2000, max = &quot;20.0 A&quot;}}
restriction  = &quot;IntraMolecular&quot;
</code></pre>
<h2>Coulombic interactions</h2>
<p>The method for treatment of electrostatic interactions is specified in the
<code>coulomb</code> section. There are multiple
<a href="input/potentials.html#Electrostatic%20interactions">available</a> solvers for
electrostatic interactions. Optionally, an additional
<a href="input/potentials.html#Restrictions">restriction</a> can be specified with the
<code>restriction</code> key.</p>
<pre><code class="language-toml">[coulomb]
ewald = {cutoff = &quot;10 A&quot;, kmax = 7}
restriction  = &quot;exclude13&quot;

[charges]
Na = 1
Cl = -1
</code></pre>
<h1>Available potentials</h1>
<p>This section is a list of all the available potentials in Cymbalum, with the
associated parameters. All potentials have to provide additional parameters in
there definition, as a TOML table. Using inline tables is the easiest way to do
so:</p>
<pre><code class="language-toml">[[pairs]]
atoms = [&quot;A&quot;, &quot;B&quot;]
# Additional parameters here are 'sigma' and 'epsilon'.
lj = {sigma = &quot;3 A&quot;, epsilon = &quot;123 kJ/mol&quot;}
</code></pre>
<p>The same potential can be used for either pairs (at distance $r$); or for
angles (at angle $\phi$). In all the formulas, the $x$ parameter
represents either a distance or an angle.</p>
<h2>Null potential</h2>
<p>This potential is always 0, for all values of $x$. It should be used to remove
interactions between atoms in a pair/bond/angle/dihedral that are
present in the system but should not be interacting.</p>
<p>This potential can be used by specifying the <code>null</code> key with an empty table <code>{}</code>
as value.</p>
<pre><code class="language-toml">[[pairs]]
atoms = [&quot;O&quot;, &quot;O&quot;]
null = {}
</code></pre>
<h2>Lennard-Jones potential</h2>
<p>The Lennard-Jones potential is a classical potential for pair interactions
expressed as: $$ V(x) = 4 \epsilon \left[\left(\frac{\sigma}{x}\right)^{12} -
\left(\frac{\sigma}{x}\right)^6\right].$$</p>
<p>The Lennard-Jones potential is defined using the <code>lj</code> or <code>lennardjones</code> key. The
parameters are <code>sigma</code> ($\sigma$) and <code>epsilon</code> ($\epsilon$), which should be
provided as strings.</p>
<pre><code class="language-toml">[[pairs]]
atoms = [&quot;O&quot;, &quot;O&quot;]
lennardjones = {sigma = &quot;3.16 A&quot;, epsilon = &quot;0.155 kcal/mol&quot;}
</code></pre>
<h2>Harmonic potential</h2>
<p>The Harmonic potential is usually used for intramolecular interactions such as
bonds, angles or dihedrals. It is expressed as:
$$ V(x) = \frac 12 k \ (x - x_0)^2$$</p>
<p>The potential type keyword is <code>harmonic</code>, and the parameters are <code>k</code> and <code>x0</code>,
provided as strings.</p>
<pre><code class="language-toml">[[bonds]]
atoms = [&quot;O&quot;, &quot;H&quot;]
harmonic = {k = &quot;1054.2 kcal/mol/A^2&quot;, x0 = &quot;1.0 A&quot;}

[[angles]]
atoms = [&quot;H&quot;, &quot;O&quot;, &quot;H&quot;]
harmonic = {k = &quot;75.9 kcal/mol/rad^2&quot;, x0 = &quot;109.5 deg&quot;}
</code></pre>
<h2>Cosine-Harmonic potential</h2>
<p>This potential is usually used for angles and dihedral angles interactions,
because it presents a $2\pi$ periodicity. It is expressed as: $$ V(x) = \frac 12
k \ (\cos x - \cos x_0)^2$$</p>
<p>The potential type keyword is <code>cosine-harmonic</code>, and the parameters <code>k</code> and <code>x0</code>
should be provided as strings.</p>
<pre><code class="language-toml">[[angles]]
atoms = [&quot;H&quot;, &quot;C&quot;, &quot;H&quot;]
cosine-harmonic = {k = &quot;67 kJ/mol&quot;, x0 = &quot;120 deg&quot;}
</code></pre>
<h2>Torsion potential</h2>
<p>This potential is usually used for dihedral interactions. It is
expressed as: $$ V(x) = k \ (1 + \cos(n x - \delta))$$</p>
<p>The potential type keyword is <code>torsion</code>, and the parameters <code>k</code> and <code>delta</code>
($\delta$) should be provided as strings, and <code>n</code> should be provided as an
integer.</p>
<pre><code class="language-toml">[[dihedrals]]
atoms = [&quot;C&quot;, &quot;C&quot;, &quot;C&quot;, &quot;C&quot;]
torsion = {k = &quot;40 kJ/mol&quot;, delta = &quot;120 deg&quot;, n: 4}
</code></pre>
<h1>Electrostatic interactions</h1>
<h2>Ewald method</h2>
<h2>Wolf method</h2>
<h1>Restrictions</h1>
<h1>Potential computations</h1>
<h2>Direct computation</h2>
<h2>Cutoff computation</h2>
<h2>Table interpolation</h2>
<h1>Units</h1>
<p>Cymbalum features a set of internal units and offers facilities to convert
from and to this set of internal units.</p>
<p>The internal unit system is the following:</p>
<ul>
<li>Angstrom ($A$) for distances;</li>
<li>Femto-second ($fs$) for time;</li>
<li>Unified atomic mass unit ($u$ or $Da$) for mass;</li>
<li>Kelvin ($K$) for temperature;</li>
<li>Number of particles for quantity of matter;</li>
<li>Radian ($rad$) for angles;</li>
</ul>
<p>Any other internal unit is derived from this set:</p>
<ul>
<li>The internal unit of energy is $u A^2 fs^{-2}$;</li>
<li>The internal unit of forces is $u A fs^{-2}$;</li>
<li>The internal unit of pressure is $u A^{-1} fs^{-2}$;</li>
<li><em>etc.</em></li>
</ul>
<p>Cymbalum knows how to convert any value in these internal unit to others units.
The accepted units are:</p>
<table><thead><tr><td> Quantity    </td><td> Accepted units                    </td></tr></thead>
<tr><td> Distance    </td><td> A, Å, nm, pm, fm, m, bohr   </td></tr>
<tr><td> Time        </td><td> fs, ps, ns                        </td></tr>
<tr><td> Mass        </td><td> u, Da, kDa, g, kg                 </td></tr>
<tr><td> Matter      </td><td> mol                               </td></tr>
<tr><td> Angle       </td><td> rad, deg                          </td></tr>
<tr><td> Energy      </td><td> J, kJ, kcal, eV, H, Ry            </td></tr>
<tr><td> Force       </td><td> N                                 </td></tr>
<tr><td> Pressure    </td><td> Pa, kPa, MPa, bar, atm            </td></tr>
</table>
<p>In the input files, the units are specified as strings, and must be spelled
exactly as in the above table. They can be combined with other units using
either a whitespace, <code>.</code> or <code>*</code> for multiplication, the <code>/</code> character for
division, and the <code>^</code> character for expontents.
For example, some valid strings are <code>kcal/mol</code>, <code>J * mol * A^-2</code>, <code>m.fs^{-1}</code>.</p>

                </div>

                <!-- Mobile navigation buttons -->
                

                

            </div>

            

            

        </div>


        <!-- Local fallback for Font Awesome -->
        <script>
            if ($(".fa").css("font-family") !== "FontAwesome") {
                $('<link rel="stylesheet" type="text/css" href="_FontAwesome/css/font-awesome.css">').prependTo('head');
            }
        </script>

        <script src="highlight.js"></script>
        <script src="book.js"></script>
    </body>
</html>
